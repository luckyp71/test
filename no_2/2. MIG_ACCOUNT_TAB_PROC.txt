create or replace PROCEDURE MIG_ACCOUNT_TAB
IS
    CURSOR MAST_ACC IS SELECT 
    a.ID, a.NAME, a.ACCOUNTNO, 
    a.ORIGINALBALANCE - b.HOLDBALANCE AS AVAILABLEBALANCE
    FROM ACCOUNT a LEFT JOIN HOLDBALANCE b
    ON a.ACCOUNTNO = b.ACCOUNTNO;
    ACC_MAST MAST_ACC%ROWTYPE;
BEGIN

   OPEN MAST_ACC;
        LOOP
             FETCH MAST_ACC INTO ACC_MAST;
             EXIT WHEN MAST_ACC%NOTFOUND;
              INSERT INTO MASTERACCOUNT VALUES (ACC_MAST.ID,
                        ACC_MAST.NAME,
                        ACC_MAST.ACCOUNTNO,
                        ACC_MAST.AVAILABLEBALANCE);


        END LOOP;
    CLOSE MAST_ACC;
    
EXCEPTION
    WHEN OTHERS THEN
        DBMS_OUTPUT.PUT_LINE(SQLERRM);
        
COMMIT;

END MIG_ACCOUNT_TAB;